

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>magpysv package &mdash; MagPySV 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="MagPySV 1.0 documentation" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> MagPySV
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="denoise.html">denoise module</a></li>
<li class="toctree-l1"><a class="reference internal" href="inputoutput.html">inputoutput module</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_prediction.html">model_prediction module</a></li>
<li class="toctree-l1"><a class="reference internal" href="svplots.html">svplots module</a></li>
<li class="toctree-l1"><a class="reference internal" href="svtools.html">svtools module</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">MagPySV</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>magpysv package</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/magpysv.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="magpysv-package">
<h1>magpysv package<a class="headerlink" href="#magpysv-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-magpysv.denoise">
<span id="magpysv-denoise-module"></span><h2>magpysv.denoise module<a class="headerlink" href="#module-magpysv.denoise" title="Permalink to this headline">¶</a></h2>
<p>Module containing functions to remove external signal from geomagnetic data.</p>
<p>Part of the MagPySV package for geomagnetic data analysis. This module provides
various functions to denoise geomagnetic data by performing principal component
analysis and identifying and removing outliers.</p>
<dl class="function">
<dt id="magpysv.denoise.detect_outliers">
<code class="descclassname">magpysv.denoise.</code><code class="descname">detect_outliers</code><span class="sig-paren">(</span><em>*</em>, <em>dates</em>, <em>signal</em>, <em>obs_name</em>, <em>window_length</em>, <em>threshold</em>, <em>plot_fig=False</em>, <em>save_fig=False</em>, <em>write_path=None</em>, <em>fig_size=(8</em>, <em>6)</em>, <em>font_size=12</em>, <em>label_size=16</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/denoise.html#detect_outliers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.denoise.detect_outliers" title="Permalink to this definition">¶</a></dt>
<dd><p>Detect outliers in a time series and remove them.</p>
<p>Use the median absolute deviation from the median (MAD) to identify
outliers. The time series are long and highly variable so it is not
appropriate to use single values of median to represent the whole series.
The function uses a running median to better characterise the series
(the window length and a threshold value stating many MADs from the median
a point must be before it is classed as an outlier are user-specified).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dates</strong> (<a class="reference external" href="https://docs.python.org/2/library/datetime.html#datetime.datetime" title="(in Python v2.7)"><em>datetime.datetime</em></a>) &#8211; dates of the time series measurements.</li>
<li><strong>signal</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; array (or column from a pandas.DataFrame) containing
the time series of interest.</li>
<li><strong>obs_name</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; states the component of interest and the three digit
IAGA observatory name.</li>
<li><strong>window_length</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; number of months over which to take the running
median.</li>
<li><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; the minimum number of median absolute deviations a
point must be away from the median in order to be considered an
outlier.</li>
<li><strong>fig_size</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; figure size in inches. Defaults to 8 inches by 6
inches.</li>
<li><strong>font_size</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; font size for axes. Defaults to 12 pt.</li>
<li><strong>label_size</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; font size for axis labels. Defaults to 16 pt.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the input signal with identified outliers removed (set to NaN).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/signal.html#module-signal" title="(in Python v2.7)">signal</a> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)">array</a>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.denoise.eigenvalue_analysis">
<code class="descclassname">magpysv.denoise.</code><code class="descname">eigenvalue_analysis</code><span class="sig-paren">(</span><em>*</em>, <em>dates</em>, <em>obs_data</em>, <em>model_data</em>, <em>residuals</em>, <em>proxy_number=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/denoise.html#eigenvalue_analysis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.denoise.eigenvalue_analysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove external signal from SV data using principal Component Analysis.</p>
<p>Perform principal component analysis (PCA) on secular variation
residuals (the difference between the observed SV and that predicted by a
geomagnetic field model) calculated from annual differences of monthly
means at several observatories. Uses masked arrays to discount missing data
points and calculates the eigenvalues/vectors of the (3nx3n) covariance
matrix for n observatories. The residuals are rotated into the
eigendirections and denoised using the method detailed in Wardinski &amp; Holme
(2011, GJI). The SV residuals of the noisy component for all observatories
combined are used as a proxy for the unmodelled external signal. The
denoised data are then rotated back into geographic coordinates. The PCA
algorithm outputs the eigenvalues sorted from largest to smallest, so the
corresponding eigenvector matrix has the &#8216;noisy&#8217; direction in the first
column and the &#8216;clean&#8217; direction in the final column.</p>
<p>This algorithm masks missing data so that they are not taken into account
during the PCA. Missing values are not infilled or estimated, so NaN
values in the input dataframe are given as NaN values in the output.</p>
<p>Smallest eigenvalue &#8216;quiet&#8217; direction</p>
<p>Largest eiegenvalue &#8216;noisy&#8217; direction</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dates</strong> (<a class="reference external" href="https://docs.python.org/2/library/datetime.html#datetime.datetime" title="(in Python v2.7)"><em>datetime.datetime</em></a>) &#8211; dates of the time series measurements.</li>
<li><strong>obs_data</strong> (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)"><em>pandas.DataFrame</em></a>) &#8211; dataframe containing columns for
monthly/annual means of the X, Y and Z components of the secular
variation at the observatories of interest.</li>
<li><strong>model_data</strong> (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)"><em>pandas.DataFrame</em></a>) &#8211; dataframe containing columns for field
model prediction of the X, Y and Z components of the secular
variation at the same observatories as in obs_data.</li>
<li><strong>residuals</strong> (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)"><em>pandas.DataFrame</em></a>) &#8211; dataframe containing the SV residuals
(difference between the observed data and model prediction).</li>
<li><strong>proxy_number</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; the number of &#8216;noisy&#8217; directions used to create
the proxy for the external signal removal. Default value is 1 (only
the residual in the direction of the largest eigenvalue is used).
Using n directions means that proxy is the sum of the SV residuals
in the n noisiest eigendirections.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p>tuple containing:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>denoised_sv (<em>pandas.DataFrame</em>):</dt>
<dd>dataframe with datetime objects in the
first column and columns for the denoised X, Y and Z SV components
at each of the observatories for which data were provided.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>proxy (<em>array</em>):</dt>
<dd>the signal that was used as a proxy for unmodelled
external magnetic field in the denoising stage.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>eig_values (<em>array</em>):</dt>
<dd>the eigenvalues of the obs_data matrix.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>eig_vectors (<em>array</em>):</dt>
<dd>the eigenvectors associated with the n largest
eigenvalues of the data matrix. For example, if the residuals
in the two &#8216;noisiest&#8217; directions are used as the proxy for external
signal, then these two eigenvectors are returned.</dd>
</dl>
</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(<a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)">tuple</a>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.denoise.eigenvalue_analysis_impute">
<code class="descclassname">magpysv.denoise.</code><code class="descname">eigenvalue_analysis_impute</code><span class="sig-paren">(</span><em>*</em>, <em>dates</em>, <em>obs_data</em>, <em>model_data</em>, <em>residuals</em>, <em>proxy_number=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/denoise.html#eigenvalue_analysis_impute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.denoise.eigenvalue_analysis_impute" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove external signal from SV data using Principal Component Analysis.</p>
<p>Perform principal component analysis (PCA) on secular variation
residuals (the difference between the observed SV and that predicted by a
geomagnetic field model) calculated from annual differences of monthly
means at several observatories. Uses the imputer from sklearn.preprocessing
to fill in missing data points and calculates the singular values of the
data matrix for n observatories (uses Singular Values Decomposition, SVD).
The residuals are rotated into the eigendirections and denoised using the
method detailed in Wardinski &amp; Holme (2011). The SV residuals of the noisy
component for all observatories combined are used as a proxy for the
unmodelled external signal. The denoised data are then rotated back into
geographic coordinates. The pca algorithm outputs the singular values
(these are equal to the square root of the eigenvalues of the covariance
matrix) sorted from largest to smallest, so the corresponding eigenvector
matrix has the &#8216;noisy&#8217; direction in the first column and the &#8216;clean&#8217;
direction in the final column.</p>
<p>Note that the SVD algorithm cannot be used if any data are missing, which
is why imputation is needed with this method. The function
denoise.eigenvalue_analysis permits missing values and does not
infill them.</p>
<p>Smallest eigenvalue: &#8216;quiet&#8217; direction</p>
<p>Largest eiegenvalue: &#8216;noisy&#8217; direction</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dates</strong> (<a class="reference external" href="https://docs.python.org/2/library/datetime.html#datetime.datetime" title="(in Python v2.7)"><em>datetime.datetime</em></a>) &#8211; dates of the time series measurements.</li>
<li><strong>obs_data</strong> (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)"><em>pandas.DataFrame</em></a>) &#8211; dataframe containing columns for
monthly/annual means of the X, Y and Z components of the secular
variation at the observatories of interest.</li>
<li><strong>model_data</strong> (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)"><em>pandas.DataFrame</em></a>) &#8211; dataframe containing columns for field
model prediction of the X, Y and Z components of the secular
variation at the same observatories as in obs_data.</li>
<li><strong>residuals</strong> (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)"><em>pandas.DataFrame</em></a>) &#8211; dataframe containing the SV residuals
(difference between the observed data and model prediction).</li>
<li><strong>proxy_number</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; the number of &#8216;noisy&#8217; directions used to create
the proxy for the external signal removal. Default value is 1 (only
the residual in the direction of the largest eigenvalue is used).
Using n directions means that proxy is the sum of the SV residuals
in the n noisiest eigendirections.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p>tuple containing:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>denoised_sv (<em>pandas.DataFrame</em>):</dt>
<dd>dataframe with dates in the first
column and columns for the denoised X, Y and Z secular variation
components at each of the observatories for which data were
provided.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>proxy (<em>array</em>):</dt>
<dd>the signal that was used as a proxy for unmodelled
external magnetic field in the denoising stage.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>eig_values (<em>array</em>):</dt>
<dd>the singular values of the obs_data matrix.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>eig_vectors (<em>array</em>):</dt>
<dd>the eigenvectors associated with the n largest
singular values of the data matrix. For example, if the residuals
in the two &#8216;noisiest&#8217; directions are used as the proxy for external
signal, then these two eigenvectors are returned.</dd>
</dl>
</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(<a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)">tuple</a>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-magpysv.inputoutput">
<span id="magpysv-inputoutput-module"></span><h2>magpysv.inputoutput module<a class="headerlink" href="#module-magpysv.inputoutput" title="Permalink to this headline">¶</a></h2>
<p>Module containing functions to parse World Data Centre (WDC) files.</p>
<p>Part of the MagPySV package for geomagnetic data analysis. This module provides
various functions to read, parse and manipulate the contents of World Data
Centre (WDC) formatted files containing geomagnetic data and output data to
comma separated values (CSV) files. Also contains functions to read output of
code used for the COV-OBS magnetic field model series by Gillet et al. (2013,
Geochem. Geophys. Geosyst.; 2015, Earth, Planets and Space).</p>
<dl class="function">
<dt id="magpysv.inputoutput.ae_parsefile">
<code class="descclassname">magpysv.inputoutput.</code><code class="descname">ae_parsefile</code><span class="sig-paren">(</span><em>fname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/inputoutput.html#ae_parsefile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.inputoutput.ae_parsefile" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a WDC-like format AE file and place contents into a dataframe.</p>
<p>Load a file of AE (Auroral Electroject)
index hourly data in the format distributed by the Kyoto WDC at
<a class="reference external" href="http://wdc.kugi.kyoto-u.ac.jp/dstae/index.html">http://wdc.kugi.kyoto-u.ac.jp/dstae/index.html</a> and extract the contents.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fname</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; path to a WDC-like formatted AE file.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">dataframe containing hourly AE data. First column is a
series of datetime objects (in the format yyyy-mm-dd hh:30:00) and
second column contains theAE values at the specified times.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">data (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)">pandas.DataFrame</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.inputoutput.ae_readfile">
<code class="descclassname">magpysv.inputoutput.</code><code class="descname">ae_readfile</code><span class="sig-paren">(</span><em>fname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/inputoutput.html#ae_readfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.inputoutput.ae_readfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper function to call ae_parsefile and wdc_datetimes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fname</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; path to a AE file in Kyoto WDC-like format. Assumes data
for all years are contained within this file.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">dataframe containing the data read from the WDC file. First column
is a series of datetime objects (in the format yyyy-mm-dd hh:30:00)
and second column contains AE values at the specified times
(hourly means).</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">data (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)">pandas.DataFrame</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.inputoutput.angles_to_geographic">
<code class="descclassname">magpysv.inputoutput.</code><code class="descname">angles_to_geographic</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/inputoutput.html#angles_to_geographic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.inputoutput.angles_to_geographic" title="Permalink to this definition">¶</a></dt>
<dd><p>Use D and H values to calculate the X and Y field components.</p>
<p>The declination (D) and horizontal intensity (H) relate to the north (Y)
and east (X) components as follows:</p>
<p>X = H*cos(D)</p>
<p>Y = H*sin(D)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)"><em>pandas.DataFrame</em></a>) &#8211; dataframe containing columns for datetime
objects and hourly means of the magnetic field components (D, I, F,
H, X, Y or Z).</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the same dataframe with datetime objects in the first column and
hourly means of the field components in either nT or degrees
(depending on the component).</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">data (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)">pandas.DataFrame</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.inputoutput.ap_readfile">
<code class="descclassname">magpysv.inputoutput.</code><code class="descname">ap_readfile</code><span class="sig-paren">(</span><em>fname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/inputoutput.html#ap_readfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.inputoutput.ap_readfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Load an kp/ap file and place the hourly ap values into a dataframe.</p>
<p>Load a datafile of 3-hourly ap data and extract the contents. Each of the
3-hourly values for a given day is repeated three times to give an hourly
mean for all 24 hours of the day. This function is designed to read files
downloaded from the GFZ, Potsdam server at
<a class="reference external" href="ftp://ftp.gfz-potsdam.de/pub/home/obs/kp-ap/">ftp://ftp.gfz-potsdam.de/pub/home/obs/kp-ap/</a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fname</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; path to an ap datafile.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">dataframe containing hourly ap data. First column is a
series of datetime objects (in the format yyyy-mm-dd hh:30:00) and
second column contains ap values at the specified times.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">data (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)">pandas.DataFrame</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.inputoutput.append_ae_data">
<code class="descclassname">magpysv.inputoutput.</code><code class="descname">append_ae_data</code><span class="sig-paren">(</span><em>ae_data_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/inputoutput.html#append_ae_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.inputoutput.append_ae_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Append AE data into a single dataframe containing all years.</p>
<p>Data downloaded from
<a class="reference external" href="ftp://ftp.ngdc.noaa.gov/STP/GEOMAGNETIC_DATA/INDICES/AURORAL_ELECTROJET/HOURLY/">ftp://ftp.ngdc.noaa.gov/STP/GEOMAGNETIC_DATA/INDICES/AURORAL_ELECTROJET/HOURLY/</a>
come in WDC-like format files with one file per year named aeyyyy.wdc (data
provided by the WDC at Kyoto. Can be downloaded directly from
<a class="reference external" href="http://wdc.kugi.kyoto-u.ac.jp/dstae/index.html">http://wdc.kugi.kyoto-u.ac.jp/dstae/index.html</a>)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ae_data_path</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; path to directory containing WDC-like format AE
datafiles. All AE files should be located in the same directory.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>dataframe containing all available hourly AE data. First column is</dt>
<dd>a series of datetime objects (in the format yyyy-mm-dd hh:30:00)
and second column contains AE values at the specified times.</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">data (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)">pandas.DataFrame</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.inputoutput.append_ap_data">
<code class="descclassname">magpysv.inputoutput.</code><code class="descname">append_ap_data</code><span class="sig-paren">(</span><em>ap_data_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/inputoutput.html#append_ap_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.inputoutput.append_ap_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Append ap data into a single dataframe containing all years.</p>
<p>Data downloaded from <a class="reference external" href="ftp://ftp.gfz-potsdam.de/pub/home/obs/kp-ap/wdc/">ftp://ftp.gfz-potsdam.de/pub/home/obs/kp-ap/wdc/</a>
come in WDC-like format files with one file per year named kpyyyy.wdc. This
function concatenates all years into a single dataframe.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ap_data_path</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; path to directory containing WDC-like format ap
datafiles. All ap files should be located in the same directory.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>dataframe containing all available hourly ap data. First column is</dt>
<dd>a series of datetime objects (in the format yyyy-mm-dd hh:30:00)
and second column contains ap values at the specified times.</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">data (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)">pandas.DataFrame</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.inputoutput.append_wdc_data">
<code class="descclassname">magpysv.inputoutput.</code><code class="descname">append_wdc_data</code><span class="sig-paren">(</span><em>*</em>, <em>obs_name</em>, <em>path=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/inputoutput.html#append_wdc_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.inputoutput.append_wdc_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Append all WDC data for an observatory into a single dataframe.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>obs_name</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; observatory name (as 3-digit IAGA code).</li>
<li><strong>path</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; path to directory containing WDC datafiles. All files for
the observatory should be located in the same directory.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dataframe containing all available hourly geomagnetic data at a
single observatory. First column is a series of datetime objects
(in the format yyyy-mm-dd hh:30:00) and subsequent columns are the
X, Y and Z components of the magnetic field at the specified times.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">data (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)">pandas.DataFrame</a>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.inputoutput.combine_csv_data">
<code class="descclassname">magpysv.inputoutput.</code><code class="descname">combine_csv_data</code><span class="sig-paren">(</span><em>*</em>, <em>start_date</em>, <em>end_date</em>, <em>sampling_rate='MS'</em>, <em>obs_list</em>, <em>data_path</em>, <em>model_path</em>, <em>day_of_month=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/inputoutput.html#combine_csv_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.inputoutput.combine_csv_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Read and combine observatory and model SV data for several locations.</p>
<p>Calls read_csv_data to read observatory data and field model predictions
for each observatory in a list. The data and predictions for individual
observatories are combined into their respective large dataframes. The
first column contains datetime objects and subsequent columns contain X, Y
and Z secular variation/field components (in groups of three) for all
observatories.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>start_date</strong> (<a class="reference external" href="https://docs.python.org/2/library/datetime.html#datetime.datetime" title="(in Python v2.7)"><em>datetime.datetime</em></a>) &#8211; the start date of the data analysis.</li>
<li><strong>end_date</strong> (<a class="reference external" href="https://docs.python.org/2/library/datetime.html#datetime.datetime" title="(in Python v2.7)"><em>datetime.datetime</em></a>) &#8211; the end date of the analysis.</li>
<li><strong>sampling_rate</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; the sampling rate for the period of interest. The
default is &#8216;MS&#8217;, which creates a range of dates between the
specified values at monthly intervals with the day fixed as the
first of each month. Use &#8216;M&#8217; for the final day of each month. Other
useful options are &#8216;AS&#8217; (a series of dates at annual intervals,
with the day and month fixed at 01 and January respectively) and
&#8216;A&#8217; (as for &#8216;AS&#8217; but with the day/month fixed as 31 December.)</li>
<li><strong>obs_list</strong> (<em>list</em>) &#8211; list of observatory names (as 3-digit IAGA codes).</li>
<li><strong>data_path</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; path to the CSV files containing observatory data.</li>
<li><strong>model_path</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; path to the CSV files containing model SV data.</li>
<li><strong>day_of_month</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; For SV data, first differences of
monthly means have dates at the start of the month (i.e. MF of
mid-Feb minus MF of mid-Jan should give SV at Feb 1st. For annual
differences of monthly means the MF of mid-Jan year 2 minus MF of
mid-Jan year 1 gives SV at mid-July year 1. The dates of COV-OBS
output default to the first day of the month (compatible with dates
of monthly first differences SV data, but not with those of
annual differences). This option is used to set the day part of the
dates column if required. Default to 1 (all output dataframes
will have dates set at the first day of the month.)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p>tuple containing:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>obs_data (<em>pandas.DataFrame</em>):</dt>
<dd>dataframe containing SV data for all observatories in obs_list.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>model_sv_data (<em>pandas.DataFrame</em>):</dt>
<dd>dataframe containing SV predictions for all observatories in
obs_list.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>model_mf_data (<em>pandas.DataFrame</em>):</dt>
<dd>dataframe containing magnetic field predictions for all
observatories in obs_list.</dd>
</dl>
</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(<a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)">tuple</a>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.inputoutput.covobs_datetimes">
<code class="descclassname">magpysv.inputoutput.</code><code class="descname">covobs_datetimes</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/inputoutput.html#covobs_datetimes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.inputoutput.covobs_datetimes" title="Permalink to this definition">¶</a></dt>
<dd><p>Create datetime objects from COV-OBS field model output file.</p>
<p>The format output by the field model is year.decimalmonth e.g. 1960.08 is
Jan 1960.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)"><em>pandas.DataFrame</em></a>) &#8211; needs a column for decimal year (in yyyy.mm
format).</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the same dataframe with the decimal year column replced with a
series of datetime objects in the format yyyy-mm-dd.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">data (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)">pandas.DataFrame</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.inputoutput.covobs_parsefile">
<code class="descclassname">magpysv.inputoutput.</code><code class="descname">covobs_parsefile</code><span class="sig-paren">(</span><em>*</em>, <em>fname</em>, <em>data_type</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/inputoutput.html#covobs_parsefile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.inputoutput.covobs_parsefile" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads MF and SV predictions from the COV-OBS geomagnetic field model.</p>
<p>Load a datafile containing SV/MF predictions from the COV-OBS magnetic
field model series by Gillet et al. (2013, Geochem. Geophys. Geosyst.,
<a class="reference external" href="https://doi.org/10.1002/ggge.20041">https://doi.org/10.1002/ggge.20041</a>;
2015, Earth, Planets and Space, <a class="reference external" href="https://doi.org/10.1186/s40623-015-0225-z">https://doi.org/10.1186/s40623-015-0225-z</a>)
field model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fname</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; path to a COV-OBS datafile.</li>
<li><strong>data_type</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; specify whether the file contains magnetic field data
(&#8216;mf&#8217;) or or secular variation data (&#8216;sv&#8217;)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dataframe containing hourly geomagnetic data. First column is a
series of datetime objects (in the format yyyy-mm-dd) and
subsequent columns are the X, Y and Z components of the SV/MF at
the specified times.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">model_data (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)">pandas.DataFrame</a>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.inputoutput.covobs_readfile">
<code class="descclassname">magpysv.inputoutput.</code><code class="descname">covobs_readfile</code><span class="sig-paren">(</span><em>*</em>, <em>fname</em>, <em>data_type</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/inputoutput.html#covobs_readfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.inputoutput.covobs_readfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper function to call covobs_parsefile and covobs_datetimes.</p>
<p>The COV-OBS code (publically available) can be used to produce synthetic
observatory time series for other field models if the appropriate spline
file is used. The output will be of the same format as COV-OBS output and
can be read using MagPySV.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fname</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; path to a COV-OBS format datafile.</li>
<li><strong>data_type</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; specify whether the file contains magnetic field data
(&#8216;mf&#8217;) or or secular variation data (&#8216;sv&#8217;)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dataframe containing the data read from the file. First column is a
series of datetime objects (in the format yyyy-mm-dd) and
subsequent columns are the X, Y and Z components of the SV/MF at
the specified times.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">data (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)">pandas.DataFrame</a>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.inputoutput.datetime_to_decimal">
<code class="descclassname">magpysv.inputoutput.</code><code class="descname">datetime_to_decimal</code><span class="sig-paren">(</span><em>date</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/inputoutput.html#datetime_to_decimal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.inputoutput.datetime_to_decimal" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a datetime object to a decimal year.
:param date: datetime object representing an observation</p>
<blockquote>
<div>time.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the same date represented as a decimal year.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">date (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)">float</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.inputoutput.hourly_mean_conversion">
<code class="descclassname">magpysv.inputoutput.</code><code class="descname">hourly_mean_conversion</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/inputoutput.html#hourly_mean_conversion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.inputoutput.hourly_mean_conversion" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the tabular base to calculate hourly means in nT or degrees (D, I).</p>
<p>Uses the tabular base and hourly value from the WDC file to calculate the
hourly means of magnetic field components. Value is in nT for H, F, X, Y or
Z components and in degrees for D or I components. Called by wdc_xyz.</p>
<p>hourly_mean = tabular_base*100 + wdc_hourly_value (for components in nT)</p>
<p>hourly_mean = tabular_base + wdc_hourly_value/600 (for D and I components)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)"><em>pandas.DataFrame</em></a>) &#8211; dataframe containing columns for datetime
objects, magnetic field component (D, I, F, H, X, Y or Z), the
tabular base and hourly mean.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">dataframe with datetime objects in the first column and hourly
means of the field components in either nT or degrees (depending on
the component).</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/grp.html#module-grp" title="(in Python v2.7)">grp</a> (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)">pandas.DataFrame</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.inputoutput.read_csv_data">
<code class="descclassname">magpysv.inputoutput.</code><code class="descname">read_csv_data</code><span class="sig-paren">(</span><em>*</em>, <em>fname</em>, <em>data_type</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/inputoutput.html#read_csv_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.inputoutput.read_csv_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Read dataframe from a CSV file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fname</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; path to a CSV datafile.</li>
<li><strong>data_type</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; specify whether the file contains magnetic field data
(&#8216;mf&#8217;) or or secular variation data (&#8216;sv&#8217;)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dataframe containing the data read from the CSV file.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">data (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)">pandas.DataFrame</a>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.inputoutput.separate_hourly_vals">
<code class="descclassname">magpysv.inputoutput.</code><code class="descname">separate_hourly_vals</code><span class="sig-paren">(</span><em>hourstring</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/inputoutput.html#separate_hourly_vals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.inputoutput.separate_hourly_vals" title="Permalink to this definition">¶</a></dt>
<dd><p>Separate individual hourly field means from the string containing all
24 values in the WDC file. Called by wdc_parsefile.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>hourstring</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; string containing the hourly magnetic field means
parsed from a WDC file for a single day.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">list containing the hourly field values.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">hourly_vals_list (list)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.inputoutput.separate_hourly_vals_ae">
<code class="descclassname">magpysv.inputoutput.</code><code class="descname">separate_hourly_vals_ae</code><span class="sig-paren">(</span><em>hourstring</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/inputoutput.html#separate_hourly_vals_ae"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.inputoutput.separate_hourly_vals_ae" title="Permalink to this definition">¶</a></dt>
<dd><p>Separate individual hourly field means from the string containing all
24 values in the AE file. Called by ae_parsefile.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>hourstring</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; string containing the hourly AE means parsed from
a Kyoto WDC-like file for a single day.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">list containing the hourly AE values.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">hourly_vals_list (list)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.inputoutput.separate_three_hourly_vals">
<code class="descclassname">magpysv.inputoutput.</code><code class="descname">separate_three_hourly_vals</code><span class="sig-paren">(</span><em>hourstring</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/inputoutput.html#separate_three_hourly_vals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.inputoutput.separate_three_hourly_vals" title="Permalink to this definition">¶</a></dt>
<dd><p>Separate 3-hourly ap means from the string containing all 8 values.</p>
<p>Separate the 8 individual 3-hourly ap means from the string containing all
values for the day. Each value is repeated 3 times to give a value for each
hour. Called by ap_readfile.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>hourstring</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; string containing the 3-hourly ap means parsed from
a Kyoto WDC-like file for a single day.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">list containing the hourly ap values.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">hourly_vals_list (list)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.inputoutput.wdc_datetimes">
<code class="descclassname">magpysv.inputoutput.</code><code class="descname">wdc_datetimes</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/inputoutput.html#wdc_datetimes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.inputoutput.wdc_datetimes" title="Permalink to this definition">¶</a></dt>
<dd><p>Create datetime objects from the fields extracted from a WDC datafile.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)"><em>pandas.DataFrame</em></a>) &#8211; needs columns for century, year (yy format),
month, day and hour. Called by wdc_parsefile.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the same dataframe with a series of datetime objects (in the format
yyyy-mm-dd hh:30:00) in the first column.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">data (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)">pandas.DataFrame</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.inputoutput.wdc_parsefile">
<code class="descclassname">magpysv.inputoutput.</code><code class="descname">wdc_parsefile</code><span class="sig-paren">(</span><em>fname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/inputoutput.html#wdc_parsefile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.inputoutput.wdc_parsefile" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a WDC datafile and place the contents into a dataframe.</p>
<p>Load a datafile of WDC hourly geomagnetic data for a single observatory and
extract the contents. Can parse both the current WDC file format and the
previous format containing international quiet (Q) or disturbed (D) day
designation in place of the century field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fname</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; path to a WDC datafile.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">dataframe containing hourly geomagnetic data. First column is a
series of datetime objects (in the format yyyy-mm-dd hh:30:00) and
subsequent columns are the X, Y and Z components of the magnetic
field at the specified times.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">data (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)">pandas.DataFrame</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.inputoutput.wdc_readfile">
<code class="descclassname">magpysv.inputoutput.</code><code class="descname">wdc_readfile</code><span class="sig-paren">(</span><em>fname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/inputoutput.html#wdc_readfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.inputoutput.wdc_readfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper function to call wdc_parsefile, wdc_datetimes and wdc_xyz.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fname</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; path to a WDC datafile.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">dataframe containing the data read from the WDC file. First column
is a series of datetime objects (in the format yyyy-mm-dd hh:30:00)
and subsequent columns are the X, Y and Z components of the
magnetic field at the specified times (hourly means).</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">data (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)">pandas.DataFrame</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.inputoutput.wdc_to_hourly_csv">
<code class="descclassname">magpysv.inputoutput.</code><code class="descname">wdc_to_hourly_csv</code><span class="sig-paren">(</span><em>*</em>, <em>wdc_path=None</em>, <em>write_path</em>, <em>obs_list</em>, <em>print_obs=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/inputoutput.html#wdc_to_hourly_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.inputoutput.wdc_to_hourly_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert WDC file to X, Y and Z hourly means and save to CSV file.</p>
<p>Finds WDC hourly data files for all observatories in a directory path
(assumes data for all observatories are located inside the same directory).
The BGS downloading app distributes data inside a single directory
with the naming convention obsyear.wdc where obs is a three digit
observatory name in lowercase and year is a four digit year,
e.g. ngk1990.wdc or clf2013.wdc. This function converts the hourly WDC
format data to hourly X, Y and Z means, appends all years of data for a
single observatory into a single dataframe and saves the dataframe to a
CSV file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>wdc_path</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; path to the directory containing datafiles.</li>
<li><strong>write_path</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; path to which the output CSV files are written.</li>
<li><strong>obs_list</strong> (<em>list</em>) &#8211; list of observatory names (as 3-digit IAGA codes).</li>
<li><strong>print_obs</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; choose whether to print each observatory name as the
function goes through the directories. Useful for checking progress
as it can take a while to read the whole WDC dataset. Defaults to
True.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.inputoutput.wdc_xyz">
<code class="descclassname">magpysv.inputoutput.</code><code class="descname">wdc_xyz</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/inputoutput.html#wdc_xyz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.inputoutput.wdc_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert extracted WDC data to hourly X, Y and Z components in nT.</p>
<p>Missing values (indicated by 9999 in the datafiles) are replaced with NaNs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)"><em>pandas.DataFrame</em></a>) &#8211; dataframe containing columns for datetime
objects, magnetic field component (D, I, F, H, X, Y or Z), the
tabular base and hourly mean.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the same dataframe with datetime objects in the first column and
columns for X, Y and Z components of magnetic field (in nT).</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">data (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)">pandas.DataFrame</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.inputoutput.write_csv_data">
<code class="descclassname">magpysv.inputoutput.</code><code class="descname">write_csv_data</code><span class="sig-paren">(</span><em>*</em>, <em>data</em>, <em>write_path</em>, <em>obs_name</em>, <em>file_prefix=None</em>, <em>decimal_dates=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/inputoutput.html#write_csv_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.inputoutput.write_csv_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Write dataframe to a CSV file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data</strong> (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)"><em>pandas.DataFrame</em></a>) &#8211; data to be written to file.</li>
<li><strong>write_path</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; path to which the output CSV file is written.</li>
<li><strong>obs_name</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; name of observatory at which the data were obtained.</li>
<li><strong>file_prefix</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; optional string to prefix the output CSV filenames
(useful for specifying parameters used to create the dataset etc).</li>
<li><strong>decimal_dates</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; optional argument to specify that dates should be
written in decimal format rather than datetime objects. Defaults to
False.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-magpysv.model_prediction">
<span id="magpysv-model-prediction-module"></span><h2>magpysv.model_prediction module<a class="headerlink" href="#module-magpysv.model_prediction" title="Permalink to this headline">¶</a></h2>
<p>Module containing functions to run the COV-OBS (Gillet et al) field model.</p>
<p>Part of the MagPySV package for geomagnetic data analysis. Contains a function
to obtain a complete list of geomagnetic observatory locations from the WDC
webserver and another function to run the COV-OBS magnetic field model by
Gillet et al. (2015, Earth, Planets and Space) to obtain model predictions for
these observatory locations.</p>
<dl class="function">
<dt id="magpysv.model_prediction.get_observatory_list">
<code class="descclassname">magpysv.model_prediction.</code><code class="descname">get_observatory_list</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/model_prediction.html#get_observatory_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.model_prediction.get_observatory_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the complete list of observatory locations held by the WDC.</p>
<p>Obtains a dictionary containing information for all geomagnetic
observatories known to the WDC using the BGS website at:
<a class="reference external" href="http://app.geomag.bgs.ac.uk/wdc/">http://app.geomag.bgs.ac.uk/wdc/</a></p>
<p>The following information is given for each location:</p>
<dl class="docutils">
<dt>&#8216;AAA&#8217;:</dt>
<dd><p class="first">{
&#8216;code&#8217;: &#8216;AAA&#8217;,</p>
<p>&#8216;country&#8217;: &#8216;Kazakhstan&#8217;,</p>
<p>&#8216;dataAvailability&#8217;: {&#8216;hour&#8217;: {&#8216;earliest&#8217;: 1963, &#8216;latest&#8217;: 2015},</p>
<p>&#8216;minute&#8217;: {&#8216;earliest&#8217;: 2005, &#8216;latest&#8217;: 2015}},</p>
<p>&#8216;dateClosed&#8217;: None,</p>
<p>&#8216;dateOpened&#8217;: [1963, 1, 1],</p>
<p>&#8216;elevation&#8217;: 1300.0,</p>
<p>&#8216;latitude&#8217;: 43.18,</p>
<p>&#8216;longitude&#8217;: 76.92,</p>
<p class="last">&#8216;name&#8217;: &#8216;Alma Ata&#8217;
}</p>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">dictionary containing information about each geomagnetic
observatory.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">stations (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)">dict</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.model_prediction.run_covobs">
<code class="descclassname">magpysv.model_prediction.</code><code class="descname">run_covobs</code><span class="sig-paren">(</span><em>*</em>, <em>stations</em>, <em>model_path</em>, <em>output_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/model_prediction.html#run_covobs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.model_prediction.run_covobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Use observatory latitude, longitude and elevation to run COV-OBS.</p>
<p>Uses the dictionary of observatory information obtained from the WDC site
to run the COV-OBS field model Gillet et al. (2015, Earth, Planets and
Space) for every location. Converts latitude in degrees to colatitude in
radians, longitude in degrees (0 to 360) into radians (-pi to pi) and
elevation in m to km. It then runs the fortran exectuable for the field
model and passes the location data as command line arguments. The output
files are stored as mf_obs.dat and sv_obs.dat for magnetic field and
secular variation predictions respectively (e.g. mf_ngk.dat and sv_ngk.dat
for Niemegk.)</p>
<p>Assumes that the user has compiled the fortran source code and called the
executable &#8220;a.out&#8221;.  No modification to the fortran source code is
required (code can be downloaded from
<a class="reference external" href="http://www.spacecenter.dk/files/magnetic-models/COV-OBSx1/">http://www.spacecenter.dk/files/magnetic-models/COV-OBSx1/</a>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>stations</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) &#8211; dictionary containing information about each
geomagnetic observatory.</li>
<li><strong>model_path</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; path to the compiled COV-OBS executable.</li>
<li><strong>output_path</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; path to the directory in which the model output
should be stored.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-magpysv.svplots">
<span id="magpysv-svplots-module"></span><h2>magpysv.svplots module<a class="headerlink" href="#module-magpysv.svplots" title="Permalink to this headline">¶</a></h2>
<p>Module containing plotting functions.</p>
<p>Part of the MagPySV package for geomagnetic data analysis. This module provides
various plotting functions.</p>
<dl class="function">
<dt id="magpysv.svplots.compare_proxies">
<code class="descclassname">magpysv.svplots.</code><code class="descname">compare_proxies</code><span class="sig-paren">(</span><em>*</em>, <em>fname1</em>, <em>fname2</em>, <em>legend_text</em>, <em>fig_size=(8</em>, <em>6)</em>, <em>font_size=12</em>, <em>label_size=16</em>, <em>save_fig=False</em>, <em>write_path=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/svplots.html#compare_proxies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.svplots.compare_proxies" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="magpysv.svplots.plot_eigenvalues">
<code class="descclassname">magpysv.svplots.</code><code class="descname">plot_eigenvalues</code><span class="sig-paren">(</span><em>*</em>, <em>values</em>, <em>fig_size=(8</em>, <em>6)</em>, <em>font_size=12</em>, <em>label_size=16</em>, <em>save_fig=False</em>, <em>write_path=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/svplots.html#plot_eigenvalues"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.svplots.plot_eigenvalues" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot eigenvalues of the covariance matrix of SV residuals.</p>
<p>Produces a plot of the eigenvalues obtained during the principal component
analysis (PCA) of SV residuals. The largest eigenvalue represents the
eigendirection with the largest contribution to the residuals (i.e. the
&#8220;noisy&#8221; direction.). The smallest eigenvalue represents the
eigendirection with the smallest contribution to the residuals (the &#8220;clean&#8221;
direction). See Wardinski &amp; Holme (2011, GJI) for further details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>values</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; the eigenvalues obtained from the principal component
analysis of the SV residuals.</li>
<li><strong>fig_size</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; figure size in inches. Defaults to 8 inches by 6
inches.</li>
<li><strong>font_size</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; font size for axes. Defaults to 12 pt.</li>
<li><strong>label_size</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; font size for axis labels. Defaults to 16 pt.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.svplots.plot_eigenvectors">
<code class="descclassname">magpysv.svplots.</code><code class="descname">plot_eigenvectors</code><span class="sig-paren">(</span><em>*</em>, <em>obs_names</em>, <em>eigenvecs</em>, <em>fig_size=(8</em>, <em>6)</em>, <em>font_size=12</em>, <em>label_size=16</em>, <em>save_fig=False</em>, <em>write_path=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/svplots.html#plot_eigenvectors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.svplots.plot_eigenvectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot eigenvectors of the covariance matrix of SV residuals.</p>
<p>Produces a plot of the eigenvectors corresponding to the n largest
eigenvalues of the covariance matrix obtained during PCA of SV residuals,
where n is the number of eigenvalues used as a proxy for unmodelled
external field signal. The n eigenvectors corresponding to the n largest
eigenvalue represent the directions with the largest contribution
to the residuals (i.e. the &#8220;noisiest&#8221; directions). See Wardinski &amp; Holme
(2011, GJI) for further details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>obs_names</strong> (<em>list</em>) &#8211; list of observatory names given as three digit IAGA
codes.</li>
<li><strong>eigenvecs</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; the eigenvalues obtained from the principal</li>
<li><strong>analysis of the SV residuals.</strong> (<em>component</em>) &#8211; </li>
<li><strong>fig_size</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; figure size in inches. Defaults to 8 inches by 6
inches.</li>
<li><strong>font_size</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; font size for axes. Defaults to 12 pt.</li>
<li><strong>label_size</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; font size for axis labels. Defaults to 16 pt.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.svplots.plot_index">
<code class="descclassname">magpysv.svplots.</code><code class="descname">plot_index</code><span class="sig-paren">(</span><em>*</em>, <em>index_file</em>, <em>dates</em>, <em>residuals</em>, <em>fig_size=(8</em>, <em>6)</em>, <em>font_size=12</em>, <em>label_size=16</em>, <em>plot_legend=True</em>, <em>save_fig=False</em>, <em>write_path=None</em>, <em>index_name='Dst'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/svplots.html#plot_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.svplots.plot_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare the proxy used to denoise the SV data with a geomagnetic index.</p>
<p>Loads geomagnetic index and plots it alongside the signal
used as a proxy for unmodelled external signal. Both time series are
reduced to zero mean and unit variance (i.e. their zscore) for plotting.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dates</strong> (<a class="reference external" href="https://docs.python.org/2/library/datetime.html#datetime.datetime" title="(in Python v2.7)"><em>datetime.datetime</em></a>) &#8211; dates of time series measurements.</li>
<li><strong>index_file</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; path to the file containing index data</li>
<li><strong>residuals</strong> (<em>time series</em>) &#8211; proxy for unmodelled external signal used in
the denoising process (principal component analysis). The proxy is
the residual in the noisiest eigendirection(s).</li>
<li><strong>index_name</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; name of index used in comparison e.g. Dst or Dcx.
Defaults to Dst.</li>
<li><strong>fig_size</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; figure size in inches. Defaults to 8 inches by 6
inches.</li>
<li><strong>font_size</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; font size for axes. Defaults to 12 pt.</li>
<li><strong>label_size</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; font size for axis labels. Defaults to 16 pt.</li>
<li><strong>plot_legend</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; option to include a legend on the plot. Defaults
to True.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.svplots.plot_index_dft">
<code class="descclassname">magpysv.svplots.</code><code class="descname">plot_index_dft</code><span class="sig-paren">(</span><em>*</em>, <em>index_file</em>, <em>dates</em>, <em>signal</em>, <em>fig_size=(8</em>, <em>6)</em>, <em>font_size=12</em>, <em>label_size=16</em>, <em>plot_legend=True</em>, <em>save_fig=False</em>, <em>write_path=None</em>, <em>index_name='Dst'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/svplots.html#plot_index_dft"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.svplots.plot_index_dft" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare the DFTs of the proxy signal with that of a geomagnetic index.</p>
<p>Loads index data, calculates its DFT using an FFT algorithm and plots it
alongside the DFT of the signal used as a proxy for unmodelled external
signal. The length of the time series are padded with zeroes up to the next
power of two.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dates</strong> (<a class="reference external" href="https://docs.python.org/2/library/datetime.html#datetime.datetime" title="(in Python v2.7)"><em>datetime.datetime</em></a>) &#8211; dates of time series measurements.</li>
<li><strong>signal</strong> (<em>time series</em>) &#8211; proxy for unmodelled external signal used in the
denoising process (principal component analysis). The proxy is the
residual in the noisiest eigendirection(s).</li>
<li><strong>index_name</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; name of index used in comparison e.g. Dst or Dcx.
Defaults to Dst.</li>
<li><strong>fig_size</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; figure size in inches. Defaults to 8 inches by 6
inches.</li>
<li><strong>font_size</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; font size for axes. Defaults to 12 pt.</li>
<li><strong>label_size</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; font size for axis labels. Defaults to 16 pt.</li>
<li><strong>plot_legend</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; option to include a legend on the plot. Defaults
to True.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.svplots.plot_mf">
<code class="descclassname">magpysv.svplots.</code><code class="descname">plot_mf</code><span class="sig-paren">(</span><em>*</em>, <em>dates</em>, <em>mf</em>, <em>model</em>, <em>obs</em>, <em>model_name</em>, <em>fig_size=(8</em>, <em>6)</em>, <em>font_size=12</em>, <em>label_size=16</em>, <em>plot_legend=True</em>, <em>save_fig=False</em>, <em>write_path=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/svplots.html#plot_mf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.svplots.plot_mf" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the SV and model prediction for a single observatory.</p>
<p>Produces a plot of the X, Y and Z components of the SV and field
model prediction for a single observatory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dates</strong> (<a class="reference external" href="https://docs.python.org/2/library/datetime.html#datetime.datetime" title="(in Python v2.7)"><em>datetime.datetime</em></a>) &#8211; dates of time series measurements.</li>
<li><strong>mf</strong> (<em>time series</em>) &#8211; X, Y and Z components of magnetic field at a single
location.</li>
<li><strong>model</strong> (<em>time series</em>) &#8211; X, Y and Z components of the field predicted by a
field model for the same location as the data.</li>
<li><strong>obs</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; observatory name given as three digit IAGA code.</li>
<li><strong>model_name</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; field model name.</li>
<li><strong>fig_size</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; figure size in inches. Defaults to 8 inches by 6
inches.</li>
<li><strong>font_size</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; font size for axes. Defaults to 12 pt.</li>
<li><strong>label_size</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; font size for axis labels. Defaults to 16 pt.</li>
<li><strong>plot_legend</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; option to include a legend on the plot. Defaults
to True.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.svplots.plot_outliers">
<code class="descclassname">magpysv.svplots.</code><code class="descname">plot_outliers</code><span class="sig-paren">(</span><em>*</em>, <em>dates</em>, <em>signal</em>, <em>obs_name</em>, <em>outliers</em>, <em>fig_size=(8</em>, <em>6)</em>, <em>font_size=12</em>, <em>label_size=16</em>, <em>save_fig=False</em>, <em>write_path=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/svplots.html#plot_outliers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.svplots.plot_outliers" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the SV and identified outliers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dates</strong> (<a class="reference external" href="https://docs.python.org/2/library/datetime.html#datetime.datetime" title="(in Python v2.7)"><em>datetime.datetime</em></a>) &#8211; dates of time series measurements.</li>
<li><strong>signal</strong> (<em>time series</em>) &#8211; single component of SV at a single location.</li>
<li><strong>obs_name</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; states the SV component and observatory name given as
three digit IAGA code. For example, the X component at NGK would be
x_ngk if obs_name is taken from the pandas.DataFrame containing
SV data for all observatories combined.</li>
<li><strong>outliers</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; outliers identified by the denoise.detect_outliers
function</li>
<li><strong>fig_size</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; figure size in inches. Defaults to 8 inches by 6
inches.</li>
<li><strong>font_size</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; font size for axes. Defaults to 12 pt.</li>
<li><strong>label_size</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; font size for axis labels. Defaults to 16 pt.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.svplots.plot_residuals_dft">
<code class="descclassname">magpysv.svplots.</code><code class="descname">plot_residuals_dft</code><span class="sig-paren">(</span><em>*</em>, <em>projected_residuals</em>, <em>dates</em>, <em>fig_size=(10</em>, <em>8)</em>, <em>font_size=12</em>, <em>label_size=16</em>, <em>plot_legend=True</em>, <em>save_fig=False</em>, <em>write_path=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/svplots.html#plot_residuals_dft"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.svplots.plot_residuals_dft" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare the DFTs of the projected residuals with each other.</p>
<p>Calculates the DFT of the residuals in each eigendirection given and plots
it alongside the residuals themselves. The length of the time series are
padded with zeroes up to the next
power of two.</p>
</dd></dl>

<dl class="function">
<dt id="magpysv.svplots.plot_residuals_dft_all">
<code class="descclassname">magpysv.svplots.</code><code class="descname">plot_residuals_dft_all</code><span class="sig-paren">(</span><em>*</em>, <em>projected_residuals</em>, <em>dates</em>, <em>fig_size=(10</em>, <em>8)</em>, <em>font_size=12</em>, <em>label_size=16</em>, <em>save_fig=False</em>, <em>write_path=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/svplots.html#plot_residuals_dft_all"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.svplots.plot_residuals_dft_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare the DFTs of the projected residuals with each other.</p>
<p>Calculates the DFT of the residuals in each eigendirection given and plots
it alongside the residuals themselves. The length of the time series are
padded with zeroes up to the next
power of two.</p>
</dd></dl>

<dl class="function">
<dt id="magpysv.svplots.plot_sv">
<code class="descclassname">magpysv.svplots.</code><code class="descname">plot_sv</code><span class="sig-paren">(</span><em>*</em>, <em>dates</em>, <em>sv</em>, <em>model</em>, <em>obs</em>, <em>model_name</em>, <em>fig_size=(8</em>, <em>6)</em>, <em>font_size=12</em>, <em>label_size=16</em>, <em>plot_legend=False</em>, <em>plot_average=False</em>, <em>window_length=12</em>, <em>min_samples=3</em>, <em>save_fig=False</em>, <em>write_path=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/svplots.html#plot_sv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.svplots.plot_sv" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the SV and model prediction for a single observatory.</p>
<p>Produces a plot of the X, Y and Z components of the SV and field
model prediction for a single observatory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dates</strong> (<a class="reference external" href="https://docs.python.org/2/library/datetime.html#datetime.datetime" title="(in Python v2.7)"><em>datetime.datetime</em></a>) &#8211; dates of time series measurements.</li>
<li><strong>sv</strong> (<em>time series</em>) &#8211; X, Y and Z components of SV at a single location.</li>
<li><strong>model</strong> (<em>time series</em>) &#8211; X, Y and Z components of the SV predicted by a
field model for the same location as the data.</li>
<li><strong>obs</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; observatory name given as three digit IAGA code.</li>
<li><strong>model_name</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; field model name.</li>
<li><strong>fig_size</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; figure size in inches. Defaults to 8 inches by 6
inches.</li>
<li><strong>font_size</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; font size for axes. Defaults to 12 pt.</li>
<li><strong>label_size</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; font size for axis labels. Defaults to 16 pt.</li>
<li><strong>plot_legend</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; option to include a legend on the plot. Defaults
to False.</li>
<li><strong>plot_average</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; option to include a running average of the SV time
series on the plot. Defaults to False.</li>
<li><strong>window_length</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; number of months over which to take the running
average if this is plotted. Defaults to 12 months.</li>
<li><strong>min_samples</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; minimum number of non-NaN values that must be
present in the window in order for the running average to be
calculated rather than set to NaN. Defaults to 3 (e.g. for monthly
first differences this means that at least 3 months of data per
window are required to calculate the 12-month running average.)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.svplots.plot_sv_comparison">
<code class="descclassname">magpysv.svplots.</code><code class="descname">plot_sv_comparison</code><span class="sig-paren">(</span><em>*</em>, <em>dates</em>, <em>noisy_sv</em>, <em>denoised_sv</em>, <em>model</em>, <em>obs</em>, <em>model_name</em>, <em>fig_size=(8</em>, <em>6)</em>, <em>font_size=12</em>, <em>label_size=16</em>, <em>plot_legend=False</em>, <em>plot_average=False</em>, <em>window_length=12</em>, <em>min_samples=3</em>, <em>save_fig=False</em>, <em>write_path=None</em>, <em>corrected_residuals</em>, <em>residuals</em>, <em>plot_rms=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/svplots.html#plot_sv_comparison"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.svplots.plot_sv_comparison" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot noisy/denoised SV and model prediction for a single observatory.</p>
<p>Produces a plot of the X, Y and Z components of the noisy SV, the denoised
SV and field model prediction for a single observatory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dates</strong> (<a class="reference external" href="https://docs.python.org/2/library/datetime.html#datetime.datetime" title="(in Python v2.7)"><em>datetime.datetime</em></a>) &#8211; dates of time series measurements.</li>
<li><strong>noisy_sv</strong> (<em>time series</em>) &#8211; X, Y and Z components of uncorrected SV at a
single location.</li>
<li><strong>denoised_sv</strong> (<em>time series</em>) &#8211; X, Y and Z components of denoised SV at a
single location.</li>
<li><strong>model</strong> (<em>time series</em>) &#8211; X, Y and Z components of the SV predicted by a
field model for the same location as the data.</li>
<li><strong>model_name</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; field model name.</li>
<li><strong>obs</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; observatory name given as three digit IAGA code.</li>
<li><strong>fig_size</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; figure size in inches. Defaults to 8 inches by 6
inches.</li>
<li><strong>font_size</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; font size for axes. Defaults to 12 pt.</li>
<li><strong>label_size</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; font size for axis labels. Defaults to 16 pt.</li>
<li><strong>plot_legend</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; option to include a legend on the plot. Defaults
to False.</li>
<li><strong>plot_average</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; option to include a running average of the SV time
series on the plot. Defaults to False.</li>
<li><strong>window_length</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; number of months over which to take the running
average if this is plotted. Defaults to 12 months.</li>
<li><strong>min_samples</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; minimum number of non-NaN values that must be
present in the window in order for the running average to be
calculated rather than set to NaN. Defaults to 3 (e.g. for monthly
first differences this means that at least 3 months of data per
window are required to calculate the 12-month running average.)</li>
<li><strong>plot_rms</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; option to calculate the rms before and after denoising</li>
<li><strong>display the values on the figure. Defaults to False.</strong> (<em>and</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.svplots.rms_ratios">
<code class="descclassname">magpysv.svplots.</code><code class="descname">rms_ratios</code><span class="sig-paren">(</span><em>*</em>, <em>rms</em>, <em>fig_size=(8</em>, <em>6)</em>, <em>font_size=12</em>, <em>label_size=16</em>, <em>save_fig=False</em>, <em>write_path=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/svplots.html#rms_ratios"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.svplots.rms_ratios" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-magpysv.svtools">
<span id="magpysv-svtools-module"></span><h2>magpysv.svtools module<a class="headerlink" href="#module-magpysv.svtools" title="Permalink to this headline">¶</a></h2>
<p>Module containing functions to parse files output by magnetic field models.</p>
<p>Part of the MagPySV package for geomagnetic data analysis. This module provides
various functions to read SV files output by geomagnetic field models.</p>
<dl class="function">
<dt id="magpysv.svtools.apply_Ap_threshold">
<code class="descclassname">magpysv.svtools.</code><code class="descname">apply_Ap_threshold</code><span class="sig-paren">(</span><em>*</em>, <em>Ap_file=None</em>, <em>obs_data</em>, <em>threshold</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/svtools.html#apply_Ap_threshold"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.svtools.apply_Ap_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove observatory data for hours with Ap values above threshold value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Ap_file</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; path to file containing hourly values for the Ap index</li>
<li><strong>obs_data</strong> (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)"><em>pandas.DataFrame</em></a>) &#8211; dataframe containing hourly means of</li>
<li><strong>geomagnetic field values.</strong> (<em>observed</em>) &#8211; </li>
<li><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; the threshold Ap value. Data for days with a higher Ap
value will be replaced with NaNs and omitted from monthly (or
annual etc) means.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dataframe containing SV residuals.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">residuals (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)">pandas.DataFrame</a>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.svtools.calculate_correlation_index">
<code class="descclassname">magpysv.svtools.</code><code class="descname">calculate_correlation_index</code><span class="sig-paren">(</span><em>*</em>, <em>dates</em>, <em>signal</em>, <em>index_file</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/svtools.html#calculate_correlation_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.svtools.calculate_correlation_index" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="magpysv.svtools.calculate_residuals">
<code class="descclassname">magpysv.svtools.</code><code class="descname">calculate_residuals</code><span class="sig-paren">(</span><em>*</em>, <em>obs_data</em>, <em>model_data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/svtools.html#calculate_residuals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.svtools.calculate_residuals" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate SV residuals (observed - prediction) using datetime objects.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>obs_data</strong> (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)"><em>pandas.DataFrame</em></a>) &#8211; dataframe containing means (usually
monthly) of SV calculated from observed geomagnetic field values.</li>
<li><strong>model_data</strong> (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)"><em>pandas.DataFrame</em></a>) &#8211; dataframe containing the SV predicted by
a geomagnetic field model.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dataframe containing SV residuals.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">residuals (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)">pandas.DataFrame</a>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.svtools.calculate_sv">
<code class="descclassname">magpysv.svtools.</code><code class="descname">calculate_sv</code><span class="sig-paren">(</span><em>obs_data</em>, <em>mean_spacing=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/svtools.html#calculate_sv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.svtools.calculate_sv" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the secular variation from the observed magnetic field values.</p>
<p>Uses monthly means of geomagnetic observatory data to calculate the SV
according to user-specified sampling. The typical choices are monthly
differences of monthly means and annual differences of monthly means. For
samplings other than monthly differences, the datetime objects of the
calculated SV are taken the midpoint of the datetime objects of the field
data. E.g. differencing the means of the field January 1999 and in January
2000 yields the SV for July 1999.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>obs_data</strong> (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)"><em>pandas.DataFrame</em></a>) &#8211; dataframe containing means (usually
monthly) of observed geomagnetic field values.</li>
<li><strong>mean_spacing</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; the number of months separating the monthly mean
values used to calculate the SV. Set to 1 to use adjacent months of
data (monthly differences of monthly means) or set to 12 to
calculate annual differences of monthly means.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dataframe containing SV data.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">obs_data (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)">pandas.DataFrame</a>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.svtools.calculate_sv_index">
<code class="descclassname">magpysv.svtools.</code><code class="descname">calculate_sv_index</code><span class="sig-paren">(</span><em>obs_data</em>, <em>mean_spacing=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/svtools.html#calculate_sv_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.svtools.calculate_sv_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the secular variation of index</p>
</dd></dl>

<dl class="function">
<dt id="magpysv.svtools.data_resampling">
<code class="descclassname">magpysv.svtools.</code><code class="descname">data_resampling</code><span class="sig-paren">(</span><em>data</em>, <em>sampling='MS'</em>, <em>average_date=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/svtools.html#data_resampling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.svtools.data_resampling" title="Permalink to this definition">¶</a></dt>
<dd><p>Resample the daily geomagnetic data to a specified frequency.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)"><em>pandas.DataFrame</em></a>) &#8211; dataframe containing datetime objects and
daily means of magnetic data.</li>
<li><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; new sampling frequency. Default value is &#8216;MS&#8217;
(monthly means), which averages data for each month and sets
the datetime object to the first day of that month. Use &#8216;M&#8217;
to set the datetime object to the final day of the month.
Another useful option is &#8216;A&#8217; (annual means), which averages
data for a whole year and sets the datetime object to the final
day of the year. Use &#8216;AS&#8217; to set the datetime object to the
first day of the year.</li>
<li><strong>average_date</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; the specified resampling intervals only have
options for setting the date to the first (&#8216;MS&#8217; and &#8216;AS&#8217;) or final
(&#8216;M&#8217; and &#8216;A&#8217;) day of the month or year. For monthly averages, a
more appropriate representative date is the middle of that month
(i.e. the 15th day of the month). For annual averages, an
appropriate representative date is the middle of that year (taken
as July 1st of the year.) This option is used to set the dates to
the centre of the sampling interval. Defaults to True.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>dataframe of datetime objects and monthly/annual means of</dt>
<dd><p class="first last">observatory data.</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">data (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)">pandas.DataFrame</a>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="magpysv.svtools.remove_selected_points">
<code class="descclassname">magpysv.svtools.</code><code class="descname">remove_selected_points</code><span class="sig-paren">(</span><em>*</em>, <em>data</em>, <em>fname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/magpysv/svtools.html#remove_selected_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#magpysv.svtools.remove_selected_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove specified points from dataset based on list of points in a file.</p>
<p>Reads a list of unwanted points from a file and removes them from the
dataframe if present. E.g. If the user had monthly SV means and wished to
exclude the X value at NGK in January 2015 from the analysis, the following
line would be written in a file</p>
<p>2015-01-01,ngk,X</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)"><em>pandas.DataFrame</em></a>) &#8211; dataframe containing datetime objects and
daily means of magnetic data.</li>
<li><strong>fname</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; path to file containing a list of unwanted data points.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the same dataframe with the points removed.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">data (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.22.0)">pandas.DataFrame</a>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Grace Cox.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>